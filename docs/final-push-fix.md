# Финальное исправление Push-уведомлений

## Проблема
Push-уведомления не работают потому что у вас **Session Token**, а нужен **Access Token**.

## Быстрое решение (5 минут)

### Шаг 1: Получите правильный Access Token
1. **Откройте https://expo.dev**
2. **Войдите в аккаунт `abuingush`**
3. **Перейдите в Account Settings**
4. **Найдите раздел "Access Tokens"** (не "Session Tokens")
5. **Создайте новый Access Token**
6. **Скопируйте токен** - он должен начинаться с `ExpoToken`

### Шаг 2: Обновите .env файл
Откройте `server/.env` и замените:
```env
# БЫЛО:
EXPO_ACCESS_TOKEN=6dCiZEhwM5X5dlcq15orQCz0FjqlJ-Jf3EVlUt-q

# СТАЛО:
EXPO_ACCESS_TOKEN=ExpoToken[your-actual-access-token-here]
```

### Шаг 3: Перезапустите сервер
```bash
cd server
npm restart
```

### Шаг 4: Протестируйте
```bash
cd server
node test-push-simple.js
```

## Диагностика

### Проверьте токен:
```bash
cd server
node test-push-simple.js
```

### Если токен правильный, но уведомления не работают:

1. **Запустите приложение в Expo Go**
2. **Авторизуйтесь как клиент**
3. **Откройте экран уведомлений**
4. **Нажмите "Принудительная инициализация"**
5. **Создайте остановку через водителя**
6. **Проверьте, приходит ли уведомление**

## Возможные проблемы

### 1. Токен не работает
- Убедитесь, что это Access Token, а не Session Token
- Токен должен начинаться с `ExpoToken`

### 2. Уведомления не приходят
- Проверьте permissions в настройках устройства
- Убедитесь, что приложение не в фоне
- Проверьте, что пользователь в правильном районе

### 3. Ошибка 401
- Токен недействителен
- Получите новый Access Token

### 4. Ошибка DeviceNotRegistered
- Push-токен устарел
- Перезапустите приложение
- Переавторизуйтесь

## Прямые ссылки

- **Account Settings**: https://expo.dev/accounts/abuingush/settings
- **Access Tokens**: https://expo.dev/accounts/abuingush/settings/access-tokens
- **Project Settings**: https://expo.dev/accounts/abuingush/projects/iceberg/settings

## Тестирование после исправления

1. **Запустите приложение**
2. **Авторизуйтесь как клиент**
3. **Откройте уведомления**
4. **Создайте остановку через водителя**
5. **Проверьте push-уведомление**

## Если ничего не помогает

1. **Проверьте логи сервера** при создании остановки
2. **Проверьте логи приложения** в Expo Go
3. **Убедитесь, что база данных работает**
4. **Проверьте, что есть клиенты в районе остановки** 