# –û–±—Ä–∞–±–æ—Ç–∫–∞ 403 –æ—à–∏–±–æ–∫ –∫–æ—Ä–∑–∏–Ω—ã —Å Toast —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è–º–∏

## –ü—Ä–æ–±–ª–µ–º–∞
–ü—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–æ–≤ –≤ –∫–æ—Ä–∑–∏–Ω—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ —Å —Ä–æ–ª—è–º–∏ –æ—Ç–ª–∏—á–Ω—ã–º–∏ –æ—Ç CLIENT –≤–æ–∑–Ω–∏–∫–∞–ª–∏ –æ—à–∏–±–∫–∏:
```
Error in POST /api/cart/add: Request failed with status code 403
–û—à–∏–±–∫–∞ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ —Ç–æ–≤–∞—Ä–∞ –≤ –∫–æ—Ä–∑–∏–Ω—É: {"code": 403, "errors": [], "message": "–î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â–µ–Ω. –¢—Ä–µ–±—É–µ—Ç—Å—è —Ä–æ–ª—å: CLIENT", "status": "error"}
```

## –†–µ—à–µ–Ω–∏–µ

–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –º–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫ –∫–æ—Ä–∑–∏–Ω—ã —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Toast —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –≤–º–µ—Å—Ç–æ –≥—Ä—É–±—ã—Ö Alert'–æ–≤.

### 1. –û–±–Ω–æ–≤–ª–µ–Ω QuantityControl ‚úÖ

#### –î–æ–±–∞–≤–ª–µ–Ω—ã –∏–º–ø–æ—Ä—Ç—ã:
```javascript
import { useAuth } from '@entities/auth/hooks/useAuth';
import { useCartAvailability } from '@entities/cart';
import { useToast } from '@shared/ui/Toast';
```

#### –ü—Ä–µ–≤–µ–Ω—Ç–∏–≤–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏:
```javascript
const { isAuthenticated, currentUser } = useAuth();
const { isCartAvailable } = useCartAvailability();
const { showWarning, showError } = useToast();

// –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –∫–æ—Ä–∑–∏–Ω—ã –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
if (!isCartAvailable) {
    const userRole = currentUser?.role || '–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–∞';
    showWarning(
        `–¢–æ–ª—å–∫–æ –∫–ª–∏–µ–Ω—Ç—ã –º–æ–≥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å —Ç–æ–≤–∞—Ä—ã –≤ –∫–æ—Ä–∑–∏–Ω—É.`,
        {
            duration: 4000,
            position: 'top'
        }
    );
    return;
}
```

#### –£–ª—É—á—à–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:
```javascript
catch (error) {
    if (error.message && error.message.includes('403')) {
        showError('–î–æ—Å—Ç—É–ø –∫ –∫–æ—Ä–∑–∏–Ω–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω. –¢–æ–ª—å–∫–æ –∫–ª–∏–µ–Ω—Ç—ã –º–æ–≥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å —Ç–æ–≤–∞—Ä—ã.');
    } else {
        showError(`–û—à–∏–±–∫–∞ –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å –∫–æ—Ä–∑–∏–Ω–æ–π: ${error.message || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞'}`);
    }
}
```

#### –í–∏–∑—É–∞–ª—å–Ω–∞—è –∏–Ω–¥–∏–∫–∞—Ü–∏—è:
```javascript
const isCartControlAvailable = !autoCartManagement || isCartAvailable;
const canDecrease = /* ... */ && isCartControlAvailable;
const canIncrease = /* ... */ && isCartControlAvailable;

// –°—Ç–∏–ª–∏ —É—á–∏—Ç—ã–≤–∞—é—Ç –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –∫–æ—Ä–∑–∏–Ω—ã
borderColor: disabled || !isCartControlAvailable ? Color.colorSilver_100 : Color.primary,
backgroundColor: disabled || !isCartControlAvailable ? Color.colorSilver_200 : Color.card,
opacity: disabled || !isCartControlAvailable ? 0.6 : 1
```

### 2. –û–±–Ω–æ–≤–ª–µ–Ω ProductDetailScreen ‚úÖ

#### –ó–∞–º–µ–Ω–∞ Alert –Ω–∞ Toast:
```javascript
const { showError, showWarning } = useToast();

// –í –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞—Ö –∫–æ—Ä–∑–∏–Ω—ã
catch (error) {
    if (error.message && error.message.includes('403')) {
        showWarning('–ö–æ—Ä–∑–∏–Ω–∞ –¥–æ—Å—Ç—É–ø–Ω–∞ —Ç–æ–ª—å–∫–æ –¥–ª—è –∫–ª–∏–µ–Ω—Ç–æ–≤', {
            duration: 4000,
            position: 'top'
        });
    } else {
        showError('–ù–µ —É–¥–∞–ª–æ—Å—å –¥–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä –≤ –∫–æ—Ä–∑–∏–Ω—É', {
            duration: 3000,
            position: 'top'
        });
    }
}
```

### 3. –û–±–Ω–æ–≤–ª–µ–Ω ProductCard ‚úÖ

#### –£–ª—É—á—à–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –≤ –∫–∞—Ä—Ç–æ—á–∫–µ –ø—Ä–æ–¥—É–∫—Ç–∞:
```javascript
const { showError, showWarning } = useToast();

const handleAddToCartPress = useCallback(async () => {
    try {
        await handleAddToCart(1);
    } catch (error) {
        if (error.message && error.message.includes('403')) {
            showWarning('–ö–æ—Ä–∑–∏–Ω–∞ –¥–æ—Å—Ç—É–ø–Ω–∞ —Ç–æ–ª—å–∫–æ –¥–ª—è –∫–ª–∏–µ–Ω—Ç–æ–≤', {
                duration: 4000,
                position: 'top'
            });
        } else {
            showError('–ù–µ —É–¥–∞–ª–æ—Å—å –¥–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä –≤ –∫–æ—Ä–∑–∏–Ω—É', {
                duration: 3000,
                position: 'top'
            });
        }
    }
}, [handleAddToCart, showError, showWarning]);
```

### 4. –û–±–Ω–æ–≤–ª–µ–Ω AddToCartButton ‚úÖ

#### –ü—Ä–µ–≤–µ–Ω—Ç–∏–≤–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤ —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ–π –∫–Ω–æ–ø–∫–µ:
```javascript
const { isCartAvailable } = useCartAvailability();
const { currentUser } = useAuth();
const { showError, showWarning } = useToast();

const handlePress = useCallback(async () => {
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –∫–æ—Ä–∑–∏–Ω—ã –ø–µ—Ä–µ–¥ –ª—é–±—ã–º–∏ –¥–µ–π—Å—Ç–≤–∏—è–º–∏
    if (!isCartAvailable && (onPress || (!isInCart && productId))) {
        const userRole = currentUser?.role || '–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–∞';
        showWarning(
            `–¢–æ–ª—å–∫–æ –∫–ª–∏–µ–Ω—Ç—ã –º–æ–≥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å —Ç–æ–≤–∞—Ä—ã –≤ –∫–æ—Ä–∑–∏–Ω—É.`,
            { duration: 4000, position: 'top' }
        );
        return;
    }
    // ...
}, [/* –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –≤–∫–ª—é—á–∞—é—Ç isCartAvailable, currentUser, showError, showWarning */]);
```

## –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ —Ä–µ—à–µ–Ω–∏—è

### üéØ –£–ª—É—á—à–µ–Ω–∏—è UX:
1. **–ö—Ä–∞—Å–∏–≤—ã–µ Toast —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è** –≤–º–µ—Å—Ç–æ –≥—Ä—É–±—ã—Ö Alert'–æ–≤
2. **–ò–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è** —Å —É–∫–∞–∑–∞–Ω–∏–µ–º —Ä–æ–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
3. **–ü—Ä–µ–≤–µ–Ω—Ç–∏–≤–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞** - –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –æ—à–∏–±–æ–∫ –¥–æ –∏—Ö –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏—è
4. **–í–∏–∑—É–∞–ª—å–Ω–∞—è –æ–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å** - —ç–ª–µ–º–µ–Ω—Ç—ã –∫–æ—Ä–∑–∏–Ω—ã —Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã–º–∏

### üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:
1. **–ú–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–∞—è –∑–∞—â–∏—Ç–∞** –Ω–∞ —É—Ä–æ–≤–Ω–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
2. **–†–æ–ª—å-–æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è** –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
3. **–ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –ª–∏—à–Ω–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤** –∫ —Å–µ—Ä–≤–µ—Ä—É

### üì± –¢–∏–ø—ã —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π:

#### –î–ª—è –Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö/–Ω–µ–ø–æ–¥—Ö–æ–¥—è—â–∏—Ö —Ä–æ–ª–µ–π:
- **–¢–∏–ø**: Warning (–∂–µ–ª—Ç—ã–π)
- **–°–æ–æ–±—â–µ–Ω–∏–µ**: "–ö–æ—Ä–∑–∏–Ω–∞ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞ –¥–ª—è —Ä–æ–ª–∏ [–†–û–õ–¨]. –¢–æ–ª—å–∫–æ –∫–ª–∏–µ–Ω—Ç—ã –º–æ–≥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å —Ç–æ–≤–∞—Ä—ã –≤ –∫–æ—Ä–∑–∏–Ω—É."
- **–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**: 4 —Å–µ–∫—É–Ω–¥—ã

#### –î–ª—è –æ—à–∏–±–æ–∫ 403:
- **–¢–∏–ø**: Warning (–∂–µ–ª—Ç—ã–π) 
- **–°–æ–æ–±—â–µ–Ω–∏–µ**: "–ö–æ—Ä–∑–∏–Ω–∞ –¥–æ—Å—Ç—É–ø–Ω–∞ —Ç–æ–ª—å–∫–æ –¥–ª—è –∫–ª–∏–µ–Ω—Ç–æ–≤"
- **–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**: 4 —Å–µ–∫—É–Ω–¥—ã

#### –î–ª—è –¥—Ä—É–≥–∏—Ö –æ—à–∏–±–æ–∫:
- **–¢–∏–ø**: Error (–∫—Ä–∞—Å–Ω—ã–π)
- **–°–æ–æ–±—â–µ–Ω–∏–µ**: "–û—à–∏–±–∫–∞ –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å –∫–æ—Ä–∑–∏–Ω–æ–π: [–î–ï–¢–ê–õ–ò]"
- **–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**: 3 —Å–µ–∫—É–Ω–¥—ã

## –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –æ—à–∏–±–æ–∫

### ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:
1. **QuantityControl** - –≥–ª–∞–≤–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Ç–æ–≤–∞—Ä–∞
2. **ProductDetailScreen** - —ç–∫—Ä–∞–Ω –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞
3. **ProductCard** - –∫–∞—Ä—Ç–æ—á–∫–∞ —Ç–æ–≤–∞—Ä–∞ –≤ —Å–ø–∏—Å–∫–∞—Ö
4. **AddToCartButton** - —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è –∫–Ω–æ–ø–∫–∞ –∫–æ—Ä–∑–∏–Ω—ã

### üîÑ –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã:

#### –î–ª—è CLIENT —Ä–æ–ª–∏:
- ‚úÖ –í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∫–æ—Ä–∑–∏–Ω—ã —Ä–∞–±–æ—Ç–∞—é—Ç
- ‚úÖ –£—Å–ø–µ—à–Ω—ã–µ Toast –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏/—É–¥–∞–ª–µ–Ω–∏–∏
- ‚úÖ –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

#### –î–ª—è –Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:
- ‚úÖ –õ–æ–∫–∞–ª—å–Ω–∞—è –∫–æ—Ä–∑–∏–Ω–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ –ò–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- ‚ùå –ù–µ—Ç –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ —Å–µ—Ä–≤–µ—Ä–Ω–æ–π –∫–æ—Ä–∑–∏–Ω–µ

#### –î–ª—è ADMIN, EMPLOYEE, SUPPLIER, DRIVER:
- üîí –ö–Ω–æ–ø–∫–∏ –∫–æ—Ä–∑–∏–Ω—ã –≤–∏–∑—É–∞–ª—å–Ω–æ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω—ã
- üîí Toast –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –ø—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
- ‚ùå –ó–∞–ø—Ä–æ—Å—ã –∫ —Å–µ—Ä–≤–µ—Ä—É –±–ª–æ–∫–∏—Ä—É—é—Ç—Å—è

## –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –ø–æ–¥—Ö–æ–¥

–ï—Å–ª–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è –ø–æ–ª–Ω–æ—Å—Ç—å—é **—Å–∫—Ä—ã—Ç—å –∫–Ω–æ–ø–∫–∏ –∫–æ—Ä–∑–∏–Ω—ã** –¥–ª—è –Ω–µ–ø–æ–¥—Ö–æ–¥—è—â–∏—Ö —Ä–æ–ª–µ–π, –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —É—Å–ª–æ–≤–Ω–æ–µ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥:

```javascript
// –í –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö
{isCartAvailable && (
    <AddToCartButton
        product={product}
        onPress={handleAddToCart}
    />
)}
```

–¢–µ–∫—É—â–µ–µ —Ä–µ—à–µ–Ω–∏–µ —Å Toast —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è–º–∏ –±–æ–ª–µ–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω–æ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, —Ç–∞–∫ –∫–∞–∫ –æ–Ω–∏ –ø–æ–Ω–∏–º–∞—é—Ç –ø–æ—á–µ–º—É —Ñ—É–Ω–∫—Ü–∏—è –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞, –∞ –Ω–µ –ø—Ä–æ—Å—Ç–æ –Ω–µ –≤–∏–¥—è—Ç –∫–Ω–æ–ø–∫—É.

## –†–µ–∑—É–ª—å—Ç–∞—Ç

‚úÖ **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã 403 –æ—à–∏–±–∫–∏** –¥–ª—è –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –∫–æ—Ä–∑–∏–Ω—ã
‚úÖ **–ò–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–µ Toast —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è** –≤–º–µ—Å—Ç–æ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö Alert'–æ–≤  
‚úÖ **–ü—Ä–µ–≤–µ–Ω—Ç–∏–≤–Ω–∞—è –∑–∞—â–∏—Ç–∞** –Ω–∞ —É—Ä–æ–≤–Ω–µ UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
‚úÖ **–í–∏–∑—É–∞–ª—å–Ω–∞—è –∏–Ω–¥–∏–∫–∞—Ü–∏—è** –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –∫–æ—Ä–∑–∏–Ω—ã
‚úÖ **–£–ª—É—á—à–µ–Ω–Ω—ã–π UX** –¥–ª—è –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Ç–µ–ø–µ—Ä—å –ø–æ–ª—É—á–∞—é—Ç –ø–æ–Ω—è—Ç–Ω—ã–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏—è –ø–æ—á–µ–º—É –∫–æ—Ä–∑–∏–Ω–∞ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞, –≤–º–µ—Å—Ç–æ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫.

