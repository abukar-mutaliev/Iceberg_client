# Руководство по получению EXPO_ACCESS_TOKEN

## Проблема
У вас есть Session Token (`6dCiZEhwM5X5dlcq15orQCz0FjqlJ-Jf3EVlUt-q`), но для push-уведомлений нужен Access Token.

## Решение

### Шаг 1: Войдите в Expo CLI
```bash
cd mobile
npx expo login
```

### Шаг 2: Получите Access Token через CLI
```bash
npx expo access-token
```

Если это не работает, попробуйте:

### Шаг 3: Через веб-интерфейс
1. Откройте https://expo.dev
2. Войдите в аккаунт `abuingush`
3. Перейдите в **Account Settings**
4. Найдите раздел **"Access Tokens"** (не "Session Tokens")
5. Создайте новый Access Token
6. Скопируйте токен - он должен начинаться с `ExpoToken`

### Шаг 4: Альтернативный способ
1. Откройте https://expo.dev/accounts/abuingush/projects/iceberg
2. Перейдите в **"Settings"**
3. Найдите **"Push Notifications"** или **"Access Tokens"**
4. Создайте новый токен

### Шаг 5: Проверьте токен
Правильный Access Token должен:
- Начинаться с `ExpoToken`
- Быть длиннее Session Token
- Работать с push-уведомлениями

### Шаг 6: Обновите .env
Замените в файле `server/.env`:
```env
EXPO_ACCESS_TOKEN=ExpoToken[your-actual-access-token-here]
```

### Шаг 7: Перезапустите сервер
```bash
cd server
npm restart
```

## Диагностика

### Проверьте текущий токен:
```bash
cd server
node test-push-simple.js
```

### Если токен правильный, но уведомления не работают:
1. Проверьте, что приложение запущено
2. Проверьте permissions уведомлений
3. Проверьте, что пользователь авторизован как CLIENT
4. Проверьте, что есть активные push-токены в базе данных

## Тестирование

После получения правильного токена:

1. **Запустите приложение в Expo Go**
2. **Авторизуйтесь как клиент**
3. **Откройте экран уведомлений**
4. **Нажмите "Принудительная инициализация"**
5. **Создайте остановку через водителя**
6. **Проверьте, приходит ли уведомление**

## Возможные проблемы

### 1. Токен не работает
- Проверьте, что это Access Token, а не Session Token
- Убедитесь, что токен начинается с `ExpoToken`

### 2. Уведомления не приходят
- Проверьте permissions в настройках устройства
- Убедитесь, что приложение не в фоне
- Проверьте, что пользователь в правильном районе

### 3. Ошибка 401
- Токен недействителен
- Получите новый Access Token

### 4. Ошибка DeviceNotRegistered
- Push-токен устарел
- Перезапустите приложение
- Переавторизуйтесь 