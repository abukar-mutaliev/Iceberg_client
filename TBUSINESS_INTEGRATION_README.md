# –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –¢-–ë–∏–∑–Ω–µ—Å –≤ –º–æ–±–∏–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

## ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

### 1. PaymentApi (`mobile/src/entities/payment/api/paymentApi.js`)
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω—ã –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏: –ÆKassa ‚Üí –¢-–ë–∏–∑–Ω–µ—Å
- ‚úÖ API endpoints –æ—Å—Ç–∞–ª–∏—Å—å —Å–æ–≤–º–µ—Å—Ç–∏–º—ã–º–∏
- ‚úÖ –ò–∑–º–µ–Ω–µ–Ω—ã –æ–ø–∏—Å–∞–Ω–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –¥–ª—è –¢-–ë–∏–∑–Ω–µ—Å

### 2. PaymentScreen (`mobile/src/screens/payment/ui/PaymentScreen/ui/PaymentScreen.jsx`)
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω –∑–∞–≥–æ–ª–æ–≤–æ–∫ —ç–∫—Ä–∞–Ω–∞
- ‚úÖ –ò–∑–º–µ–Ω–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–æ–º–µ–Ω–æ–≤:
  - –ë—ã–ª–æ: `yoomoney.ru`, `yookassa.ru`
  - –°—Ç–∞–ª–æ: `tinkoff.ru`, `tbank.ru`, `securepay.tinkoff.ru`

### 3. CheckoutScreen (`mobile/src/screens/cart/ui/CheckoutScreen/ui/CheckoutScreen.jsx`)
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–æ –æ–ø–∏—Å–∞–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã:
  - –ë—ã–ª–æ: "–ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –æ–ø–ª–∞—Ç–∞ —á–µ—Ä–µ–∑ –Æ–ö–∞—Å—Å–∞"
  - –°—Ç–∞–ª–æ: "–ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –æ–ø–ª–∞—Ç–∞ —á–µ—Ä–µ–∑ –¢-–ë–∏–∑–Ω–µ—Å"

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### API Endpoints (–æ—Å—Ç–∞–ª–∏—Å—å –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π)
```javascript
// –°–æ–∑–¥–∞–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–∞
POST /api/payments/orders/{orderId}/create

// –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –ø–ª–∞—Ç–µ–∂–∞
GET /api/payments/status/{paymentId}

// –û—Ç–º–µ–Ω–∞ –ø–ª–∞—Ç–µ–∂–∞
POST /api/payments/{paymentId}/cancel
```

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–ª–∞—Ç–µ–∂–∞
```javascript
PaymentApi.createPayment(orderId, {
    returnUrl: 'icebergapp://payment-result',  // Deep link –¥–ª—è –≤–æ–∑–≤—Ä–∞—Ç–∞
    preauthorization: false,                    // –ü—Ä–µ–¥–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è (true/false)
    paymentMethodType: 'sbp'                   // –¢–∏–ø –ø–ª–∞—Ç–µ–∂–∞: 'sbp', 'card'
});
```

### –î–æ–º–µ–Ω—ã –¥–ª—è WebView
```javascript
// –†–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–µ –¥–æ–º–µ–Ω—ã –¥–ª—è –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ –≤ WebView
const allowedDomains = [
    'tinkoff.ru',
    'tbank.ru',
    'securepay.tinkoff.ru'
];
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### 1. –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
```javascript
// –¢–µ—Å—Ç–æ–≤–∞—è –∫–∞—Ä—Ç–∞ –¢-–ë–∞–Ω–∫–∞
CARD_NUMBER: "4300 0000 0000 0777"
EXPIRY: "12/30"
CVV: "111"
```

### 2. –ü—Ä–æ—Ü–µ—Å—Å —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
1. –°–æ–∑–¥–∞—Ç—å –∑–∞–∫–∞–∑ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏
2. –ü–µ—Ä–µ–π—Ç–∏ –∫ –æ–ø–ª–∞—Ç–µ
3. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—É—é –∫–∞—Ä—Ç—É
4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —É—Å–ø–µ—à–Ω–æ–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ –æ–ø–ª–∞—Ç—ã

### 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤
```bash
# –í –∫–æ–Ω—Å–æ–ª–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ª–æ–≥–∏:
‚úÖ Payment created: {...}
‚úÖ Allowed navigation to: https://securepay.tinkoff.ru/...
‚úÖ Payment result deep link detected
```

## üîÑ –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

### ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–æ:
- API –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã
- –ù–∞–≤–∏–≥–∞—Ü–∏—è –º–µ–∂–¥—É —ç–∫—Ä–∞–Ω–∞–º–∏
- –õ–æ–≥–∏–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø–ª–∞—Ç–µ–∂–µ–π
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- Deep links (`icebergapp://payment-result`)

### ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–æ:
- –ù–∞–∑–≤–∞–Ω–∏—è –ø–ª–∞—Ç–µ–∂–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã –≤ UI
- –î–æ–º–µ–Ω—ã –¥–ª—è WebView
- –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

## üöÄ –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

–ú–æ–±–∏–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–æ–ª–Ω–æ—Å—Ç—å—é –≥–æ—Ç–æ–≤–æ –∫ —Ä–∞–±–æ—Ç–µ —Å –¢-–ë–∏–∑–Ω–µ—Å:

1. **–°–µ—Ä–≤–µ—Ä–Ω–∞—è —á–∞—Å—Ç—å** - –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –¢-–ë–∏–∑–Ω–µ—Å API
2. **–ú–æ–±–∏–ª—å–Ω–∞—è —á–∞—Å—Ç—å** - –æ–±–Ω–æ–≤–ª–µ–Ω—ã UI –∏ API –∫–ª–∏–µ–Ω—Ç—ã
3. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** - –≥–æ—Ç–æ–≤—ã —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏

## üìû –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **–ü–æ–ª—É—á–∏—Ç—å –Ω–∞—Å—Ç–æ—è—â–∏–µ –∫–ª—é—á–∏** –æ—Ç –¢-–ë–∞–Ω–∫–∞ (Terminal Key + Password)
2. **–û–±–Ω–æ–≤–∏—Ç—å `.env`** –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
3. **–ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç—ã** —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –∫–ª—é—á–∞–º–∏
4. **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å** –ø–æ–ª–Ω—ã–π —Ü–∏–∫–ª –æ–ø–ª–∞—Ç—ã
5. **–í–Ω–µ–¥—Ä–∏—Ç—å** –≤ –ø—Ä–æ–¥–∞–∫—à–Ω

---

**–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –¢-–ë–∏–∑–Ω–µ—Å –∑–∞–≤–µ—Ä—à–µ–Ω–∞!** üéâ



