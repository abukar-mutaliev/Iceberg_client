# Руководство по тестированию на iPhone

## Проблема
На Windows Expo CLI не показывает опцию iOS, так как нет iOS симулятора. Для тестирования на физическом iPhone нужно использовать development build.

## ⚠️ Важно: Требования для iOS сборки

Для сборки iOS приложения через EAS Build **необходим платный Apple Developer аккаунт** ($99/год).

### Решение проблемы "You have no team associated with your Apple account"

#### ⏳ Аккаунт в процессе активации (наиболее вероятная причина)

Если вы **только что создали и оплатили** Apple Developer аккаунт, он может быть еще в процессе активации:

- **Время активации:** обычно от нескольких часов до 2-3 дней после оплаты
- **Что делать:**
  1. Проверьте статус в Apple Developer Portal: https://developer.apple.com/account
  2. Дождитесь активации (вы получите email-уведомление)
  3. После активации попробуйте снова: `npm run build:ios:dev`

#### Другие возможные причины и решения:

1. **Проверьте Apple Developer Portal:**
   - Откройте https://developer.apple.com/account
   - Убедитесь, что вы вошли в систему
   - Проверьте статус членства (должно быть "Active")
   - Проверьте, что все соглашения приняты (Agreements должны быть в статусе "Active")

2. **Примите все соглашения:**
   - В Apple Developer Portal перейдите в раздел "Agreements, Tax, and Banking"
   - Примите все ожидающие соглашения (если есть)

3. **Проверьте членство в команде:**
   - Убедитесь, что ваш аккаунт является членом команды Developer Program
   - Если вы индивидуальный разработчик, команда должна быть создана автоматически после активации

4. **Повторная попытка сборки:**
   ```bash
   npm run build:ios:dev
   ```

5. **Если проблема сохраняется, попробуйте очистить credentials:**
   ```bash
   eas credentials
   ```
   Затем выберите iOS и удалите существующие credentials, после чего попробуйте снова.

## Решение: Development Build для iOS

### Шаг 1: Собрать iOS Development Build

Выполните команду для сборки development build в облаке:

```bash
npm run build:ios:dev
```

Или напрямую:
```bash
eas build --profile development --platform ios
```

Это создаст development build в облаке через EAS Build. Сборка займет 10-20 минут.

### Шаг 2: Установить на iPhone

После завершения сборки:

1. Откройте ссылку на сборку из терминала или в браузере перейдите на https://expo.dev/accounts/abuingush/projects/iceberg/builds
2. Отсканируйте QR-код с iPhone или откройте ссылку на iPhone
3. Установите приложение на iPhone (может потребоваться доверие разработчику в Настройках > Основные > Управление устройством)

### Шаг 3: Запустить Metro Bundler с tunnel

После установки development build на iPhone:

```bash
npm run start:tunnel
```

Или:
```bash
expo start --tunnel
```

Tunnel режим создаст публичный URL, доступный с любого устройства, включая iPhone.

### Шаг 4: Подключиться с iPhone

1. Откройте установленное development build приложение на iPhone
2. Приложение автоматически подключится к Metro bundler через tunnel
3. Если не подключается автоматически, встряхните iPhone и выберите "Configure Bundler", затем введите URL из терминала

## ⚡ Временное решение: Тестирование через Expo Go (пока аккаунт активируется)

**⚠️ Внимание:** Ваш проект использует `expo-dev-client`, поэтому Expo Go может не поддерживать все функции. Но для базового тестирования можно попробовать:

### Способ 1: Через стандартную камеру iPhone (рекомендуется)

1. **Скачайте Expo Go** из App Store на iPhone
2. **Запустите Metro bundler с tunnel:**
   ```bash
   npm run start:tunnel
   ```
3. **Откройте стандартное приложение Камера** на iPhone (не Expo Go!)
4. **Наведите камеру на QR-код** в терминале
5. **Нажмите на уведомление**, которое появится вверху экрана
6. Приложение откроется в Expo Go автоматически

### Способ 2: Ввод URL вручную

1. **Запустите Metro bundler:**
   ```bash
   npm run start:tunnel
   ```
2. **Скопируйте URL** из терминала (выглядит как `exp://...`)
3. **Откройте Expo Go** на iPhone
4. **Нажмите на поле "Enter URL manually"** или "Paste URL" внизу экрана
5. **Вставьте скопированный URL** и нажмите "Connect"

### Способ 3: Через встряхивание устройства

1. **Запустите Metro bundler:**
   ```bash
   npm run start:tunnel
   ```
2. **Откройте Expo Go** на iPhone
3. **Встряхните iPhone** (shake gesture)
4. **Выберите "Enter URL manually"**
5. **Введите URL** из терминала

### Способ 4: Через Safari (если есть ссылка)

1. **Запустите Metro bundler:**
   ```bash
   npm run start:tunnel
   ```
2. **Скопируйте URL** из терминала
3. **Откройте Safari** на iPhone
4. **Вставьте URL** в адресную строку
5. Safari предложит открыть в Expo Go

**Ограничения:**
- Не все нативные модули могут работать в Expo Go
- OneSignal и другие кастомные плагины могут не работать
- Это временное решение только для базового тестирования UI

## Альтернативный способ: LAN режим (если iPhone и компьютер в одной сети)

Если ваш iPhone и компьютер подключены к одной Wi-Fi сети:

```bash
npm start
```

Затем в приложении на iPhone (Expo Go или development build) выберите подключение по локальной сети.

## Примечания

- Development build нужно пересобирать только при изменении нативных модулей или конфигурации
- Для обычных изменений JavaScript кода достаточно просто перезагрузить приложение (shake device > Reload)
- Tunnel режим может быть медленнее, чем LAN, но работает из любой сети

## Быстрая команда для тестирования

```bash
# 1. Собрать development build (только один раз или при изменении нативных модулей)
npm run build:ios:dev

# 2. После установки на iPhone, запустить tunnel
npm run start:tunnel
```

